## 创建表结构示例
> 注意：带大写/驼峰的表名需使用双引号（例如 `"User"`、`"Role"`）。

1) 创建角色表：
```sh
psql -h localhost -U postgres -d appdb <<'SQL'
CREATE TABLE IF NOT EXISTS "Role" (
  "id" SERIAL PRIMARY KEY,
  "code" TEXT NOT NULL UNIQUE,
  "name" TEXT NOT NULL
);
SQL
```

2) 创建用户表（含外键到角色）：
```sh
psql -h localhost -U postgres -d appdb <<'SQL'
CREATE TABLE IF NOT EXISTS "User" (
  "id" SERIAL PRIMARY KEY,
  "username" TEXT NOT NULL UNIQUE,
  "passwordHash" TEXT NOT NULL,
  "nickname" TEXT,
  "roleId" INTEGER NOT NULL,
  "createdAt" TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);
SQL

psql -h localhost -U postgres -d appdb <<'SQL'
ALTER TABLE "User"
  ADD CONSTRAINT "User_roleId_fkey"
  FOREIGN KEY ("roleId") REFERENCES "Role"("id")
  ON UPDATE CASCADE ON DELETE RESTRICT;
SQL
```

## 常用增删改查
- 插入角色（存在则更新名称）：
```sh
psql -h localhost -U postgres -d appdb <<'SQL'
INSERT INTO "Role" ("code","name")
VALUES ('ADMIN','管理员')
ON CONFLICT ("code") DO UPDATE SET "name" = EXCLUDED."name";
SQL
```

```sh
psql -h localhost -U postgres -d appdb <<'SQL'
DELETE FROM "Role"
WHERE "code" = 'ADMIN';
SQL
```

- 插入用户（示例，默认角色 ID=1）：
```sh
psql -h localhost -U postgres -d appdb <<'SQL'
INSERT INTO "User" ("username","passwordHash","nickname","roleId")
VALUES ('alice','$2a$10$...bcrypthash...','Alice',1);
SQL
```

- 更新用户角色：
```sh
psql -h localhost -U postgres -d appdb <<'SQL'
UPDATE "User" SET "roleId"=2 WHERE "username"='alice';
SQL
```
- 删除用户：
```sh
psql -h localhost -U postgres -d appdb <<'SQL'
DELETE FROM "User" WHERE "username"='alice';
SQL
```
- 查询用户列表：
```sh
psql -h localhost -U postgres -d appdb <<'SQL'
SELECT id, username, nickname, roleId, createdAt FROM "User"
ORDER BY createdAt DESC;
SQL
```
